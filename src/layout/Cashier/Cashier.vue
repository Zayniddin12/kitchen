<script setup lang="ts">
import { computed, onMounted, reactive, ref, watch } from "vue";
import { filterObjectValues, formatNumber } from "@/utils/helper";
import AppEmpty from "@/components/ui/app-empty/AppEmpty.vue";
import useConfirm from "@/components/ui/app-confirm/useConfirm";
import HeaderUser from "@/components/layouts/header-user/HeaderUser.vue";
import { useAuthStore } from "@/modules/Auth/auth.store";
import tokenManager from "@/utils/token.manager";
import { WarehouseCapacityParamsType } from "@/modules/Home/statistics.types";
import { useRoute } from "vue-router";

const products = ref([
  {
    id: 1,
    name: "Глазунья",
    price: 24000,
    unit_name: "200 гр",
    img: "/meal.png",
  },
  {
    id: 2,
    name: "Колбаса жареная",
    price: 24000,
    unit_name: "200 гр",
    img: "/meal2.png",
  },
  {
    id: 3,
    name: "Рисовая каша",
    price: 24000,
    unit_name: "200 гр",
    img: "/meal3.png",
  },
  {
    id: 4,
    name: "Каша Геркулес",
    price: 24000,
    unit_name: "200 гр",
    img: "/meal4.png",
  },
  {
    id: 5,
    name: "Гренки из серого хлеба",
    price: 24000,
    unit_name: "200 гр",
    img: "/meal5.png",
  },
  {
    id: 6,
    name: "Каша манная",
    price: 24000,
    unit_name: "200 гр",
    img: "/meal6.png",
  },
  {
    id: 7,
    name: "Сырники с каймаком",
    price: 24000,
    unit_name: "200 гр",
    img: "/meal7.png",
  },
  {
    id: 8,
    name: "Блинчик с мясом",
    price: 24000,
    unit_name: "200 гр",
    img: "/meal8.png",
  },
  {
    id: 9,
    name: "Coca Cola",
    price: 24000,
    unit_name: "1.5 литр",
    img: "/cola.png",
  },
]);

const orders = reactive<Map<number, number>>(new Map());
const ordersModal = ref(false);

const route = useRoute();
const updateQuantity = (product_id: number, increment = true) => {

  const currentQuantity = orders.get(product_id) || 0;

  if (increment) {
    orders.set(product_id, currentQuantity + 1);
    ordersModal.value = true;
  } else if (currentQuantity > 0) {
    if (currentQuantity > 1) {
      orders.set(product_id, currentQuantity - 1);
    } else {
      orders.delete(product_id);

      if (orders.size === 0) ordersModal.value = false;
    }
  }
};

interface ProductItemType {
  id: number;
  price: number;
  weight: number;
  name: string;
  photo: string | object;
}

const selectedProducts = computed(() => {
  const selected = [] as ProductItemType[];

  const productMap = new Map<number, ProductItemType>();

  products.value.forEach(product => {
    productMap.set(product.id, product);
  });

  orders.forEach((quantity, product_id) => {
    const product = productMap.get(product_id);
    if (product) {
      selected.push(product);
    }
  });

  return selected;
});

const ordersSum = computed(() => {
  let totalSum = 0;

  orders.forEach((quantity, product_id) => {
    selectedProducts.value.forEach(product => {
      if (product.id === product_id) {
        totalSum += product.price * quantity;
      }
    });
  });

  return totalSum;
});

const { confirm } = useConfirm();

const clearOrders = () => {
  confirm.cancel().then(response => {
    if (response !== "confirm") return;
    orders.clear();
    ordersModal.value = false;
  });
};

const createOrder = async () => {


  try {
    // selectedProducts.value.forEach(product => {
    //   if (product.product_type == "product") {
    //     payload.products.push({
    //       menu_id: Number(product.id),
    //       id: Number(product.product_id),
    //       price: Number(product.price),
    //       quantity: Number(orders.get(product.id)),
    //     });
    //   } else {
    //     payload.meals.push({
    //       menu_id: Number(product.id),
    //       id: Number(product.product_id),
    //       price: Number(product.price),
    //       quantity: Number(orders.get(product.id)),
    //     });
    //   }
    // });

    // await kitchenStore.CREATE_ORDER(payload);
    // await kitchenStore.GET_CURRENT_MENU_SALES_LIST(route.params.child_id as string);
    orders.clear();
    ordersModal.value = false;
  } catch (error) {

  }

};
const authStore = useAuthStore();
onMounted(async () => {
  if (tokenManager.getAccessToken()) authStore.me();

});

const form = reactive<WarehouseCapacityParamsType>({
  management_id: 1,
});

const managements = ref<object[]>([
  {
    id: 1,
    name: "Завтрак",
  },
  {
    id: 2,
    name: "Первое",
  },
  {
    id: 3,
    name: "Второе",
  },
  {
    id: 4,
    name: "Салаты",
  },
  {
    id: 5,
    name: "Десерты",
  },
  {
    id: 6,
    name: "Добавки",
  },
  {
    id: 7,
    name: "Напитки",
  },

]);


watch(() => route.query.management_id, (newId) => {
  const management_id = newId ? parseInt(newId as string) : null;
  form.management_id = management_id && !isNaN(management_id) ? management_id : null;

}, { immediate: true });

const clearBasket = () => {
  confirm.delete().then(response => {
    orders.clear();
  });
};
</script>

<template>
  <div class="bg-[#F8F9FC]">
    <div class="max-w-[1510px] px-6 py-[26px] w-full h-[100vh]">
      <TransitionGroup
        name="nested"
        :duration="{ enter: 500, leave: 1500 }"
        tag="div"
        class="relative overflow-x-hidden"
      >
        <div
          class="inner"
        >
          <div
            class="flex flex-col gap-y-6"
          >
            <div>

              <div>
                <div class="flex items-center justify-between mb-[24px]">
                  <h4 class="text-[#000D24] text-[32px] font-semibold">
                    Меню
                  </h4>

                  <HeaderUser />
                </div>

                <div
                  class="app-tabs2 !text-sm mb-6"
                >
                  <RouterLink
                    v-for="item in managements"
                    :key="item.id"
                    :to="{ query: { ...route.query, ...{ management_id: item.id } } }"
                    :class="[
              'app-tab',
              { 'app-tab--active': form.management_id == item.id },
            ]"
                  >
                    {{ item.name }}
                  </RouterLink>
                </div>

                <!--              :class="productsWrapperClassName"-->
                <div class="grid grid-cols-5 gap-6">
                  <div
                    v-for="productItem in products"
                    :key="productItem.id"
                    class="menu__card !p-[8px] !bg-white"
                  >

                    <img
                      :src="productItem.img"
                      :alt="productItem.name"
                      class="object-cover rounded-[12px] w-full h-[120px]"
                    />

                    <div class="menu__card-subtitles text-start mt-[12px] mb-[16px]">
                        <span
                          class="text-[#000D24] font-semibold text-[20px] mb-[4px]">{{ formatNumber(productItem.price)
                          }} UZS</span>
                      <span class="text-[#000D24] font-medium text-[14px]">{{ productItem.name }} </span>
                    </div>

                    <h5 class="text-start text-[#A8AAAE]">
                      {{ productItem.unit_name }}
                    </h5>

                    <div
                      v-if="orders.get(productItem.id)"
                      class="menu__card__actions !justify-between  bg-[#E2E6F3] px-[24px] py-[14px] rounded-[12px]">
                      <button
                        @click="updateQuantity(productItem.id, false)"
                        :disabled="!orders.has(productItem.id)"
                        class=""
                      >
                        <svg width="20" height="20" viewBox="0 0 20 20" fill="none"
                             xmlns="http://www.w3.org/2000/svg">
                          <path d="M4.16602 9.99967H15.8327" stroke="#4F5662" stroke-width="1.2"
                                stroke-linecap="round" stroke-linejoin="round" />
                        </svg>

                      </button>
                      <span>
                        {{ orders.get(productItem.id) ?? 0 }}
                        </span>
                      <button
                        @click="updateQuantity(productItem.id)"
                        class=""
                        :disabled="productItem.amount == 0 || orders.has(productItem.id) && (orders.get(productItem.id) == productItem.amount)"
                      >
                        <svg width="21" height="20" viewBox="0 0 21 20" fill="none"
                             xmlns="http://www.w3.org/2000/svg">
                          <path d="M10.5007 4.16699V15.8337" stroke="#4F5662" stroke-width="1.2"
                                stroke-linecap="round" stroke-linejoin="round" />
                          <path d="M4.66602 9.99967H16.3327" stroke="#4F5662" stroke-width="1.2"
                                stroke-linecap="round" stroke-linejoin="round" />
                        </svg>

                      </button>
                    </div>
                    <!--                      :disabled="productItem.amount == 0 || orders.has(productItem.id) && (orders.get(productItem.id) == productItem.amount)"-->
                    <button v-else
                            @click="updateQuantity(productItem.id)"

                            class="menu__card__actions  bg-[#E2E6F3] px-[24px] py-[14px] rounded-[12px]">
                      <svg width="21" height="20" viewBox="0 0 21 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M10.5007 4.16699V15.8337" stroke="#4F5662" stroke-width="1.2" stroke-linecap="round"
                              stroke-linejoin="round" />
                        <path d="M4.66602 9.99967H16.3327" stroke="#4F5662" stroke-width="1.2" stroke-linecap="round"
                              stroke-linejoin="round" />
                      </svg>


                      Добавить
                    </button>
                  </div>
                </div>
              </div>
            </div>
            <!--          <AppEmpty-->
            <!--            v-else-->
            <!--            class="h-[60vh]"-->
            <!--          />-->
          </div>
        </div>
      </TransitionGroup>

      <Transition name="nested">
        <Teleport to="body">
          <div
            ref="ordersWrapper"
            class="fixed top-0 right-0 pt-8 pb-6 w-[410px] h-screen flex flex-col justify-between z-10 bg-white shadow-[-32px_72px_96px_0_#0926450F] rounded-l-[32px]"
          >
            <div class="flex items-center justify-between mb-4">
              <h4 class="text-xl text-black font-semibold pl-8">Корзина</h4>
              <button v-if="orders.size" @click="clearBasket" class="text-[#A8AAAE] text-[14px] pr-8">
                Очистить
              </button>
            </div>
            <div class="h-full overflow-y-auto flex flex-col">

              <div
                v-if="selectedProducts.length > 0"
                class="grid gap-6 px-8"
              >
                <!--              menu__card-->
                <div
                  class="h-[136px] p-[8px] flex gap-2 bg-[#F8F9FC] rounded-[16px]"
                  v-for="(productItem, productIndex) in selectedProducts"
                  :key="productIndex"
                >
                  <!--                {{productItem}}-->
                  <!--                menu__card-img-->
                  <img
                    :src="productItem.img"
                    :alt="productItem.name"
                    class="w-[120px] object-cover rounded-[12px]"
                  />
                  <div class="w-full">
                    <div class="flex items-center justify-between">
                      <!--                    menu__card-title-->
                      <h5 class="text-[#000D24] text-[20px] font-semibold">
                        {{ formatNumber(productItem.price) }} UZS
                      </h5>

                      <span class="text-[#A8AAAE]">{{ productItem.unit_name }} </span>
                    </div>
                    <h5 class="text-[#000D24] font-medium text-[14px] mt-[4px]">
                      {{ productItem.name }}
                    </h5>

                    <div
                      v-if="orders.get(productItem.id)"
                      class="menu__card__actions !justify-between !mt-[12px] bg-[#E2E6F3] px-[24px] py-[14px] rounded-[12px]">
                      <button
                        @click="updateQuantity(productItem.id, false)"
                        :disabled="!orders.has(productItem.id)"
                        class=""
                      >
                        <svg width="20" height="20" viewBox="0 0 20 20" fill="none"
                             xmlns="http://www.w3.org/2000/svg">
                          <path d="M4.16602 9.99967H15.8327" stroke="#4F5662" stroke-width="1.2"
                                stroke-linecap="round" stroke-linejoin="round" />
                        </svg>

                      </button>
                      <span class="h-[20px]">
                        {{ orders.get(productItem.id) ?? 0 }}
                        </span>
                      <button
                        @click="updateQuantity(productItem.id)"
                        class=""
                        :disabled="orders.has(productItem.id) && (orders.get(productItem.id) == productItem.amount)"
                      >
                        <svg width="21" height="20" viewBox="0 0 21 20" fill="none"
                             xmlns="http://www.w3.org/2000/svg">
                          <path d="M10.5007 4.16699V15.8337" stroke="#4F5662" stroke-width="1.2"
                                stroke-linecap="round" stroke-linejoin="round" />
                          <path d="M4.66602 9.99967H16.3327" stroke="#4F5662" stroke-width="1.2"
                                stroke-linecap="round" stroke-linejoin="round" />
                        </svg>

                      </button>
                    </div>
                  </div>
                </div>
              </div>
              <div v-else class="m-auto text-center">
                <svg width="256" height="169" viewBox="0 0 256 169" fill="none" xmlns="http://www.w3.org/2000/svg">
                  <g opacity="0.25">
                    <path
                      d="M-0.00585938 51.2454C-0.00585938 44.743 3.16336 38.8652 8.28326 34.6105C13.4083 30.3507 20.484 27.7139 28.3021 27.7139H51.7C50.5787 35.911 48.9045 49.7043 47.3174 68.9708C47.1126 71.4233 46.877 73.9782 46.6057 76.6099C43.2317 75.4272 39.5351 74.7769 35.6491 74.7769H28.3072C12.6761 74.7769 -0.00585938 64.24 -0.00585938 51.2454Z"
                      fill="#E2E6F3" />
                    <path
                      d="M255.994 145.366C255.994 151.864 252.825 157.747 247.7 162.006C242.58 166.266 235.504 168.898 227.686 168.898H28.3072C12.6761 168.898 -0.00585938 158.361 -0.00585938 145.366C-0.00585938 138.874 3.16336 132.986 8.28326 128.726C13.4083 124.472 20.484 121.835 28.3021 121.835H35.644C37.3387 121.835 39.0026 121.707 40.6103 121.477C38.378 135.843 36.3147 147.732 35.5109 152.268C35.3368 153.256 36.156 154.132 37.1492 154.03C81.0012 149.483 170.103 160.901 182.503 162.539C183.307 162.641 184.06 162.083 184.182 161.285C186.732 159.155 189.523 157.102 192.395 155.156L192.18 157.921L194.637 153.671C204.483 147.281 214.82 142.269 219.566 140.083C221.123 139.366 221.998 137.692 221.691 135.997C221.179 133.181 220.339 128.363 219.325 121.83H227.676C243.307 121.83 255.989 132.367 255.989 145.361H255.994V145.366Z"
                      fill="#E2E6F3" />
                    <path
                      d="M255.995 51.2456C255.995 57.7429 252.825 63.6258 247.7 67.8805C242.581 72.1403 235.505 74.7771 227.687 74.7771H213.438C213.315 73.5432 213.197 72.2939 213.08 71.0293C210.735 46.1922 208.246 30.3355 206.762 21.5957C211.789 25.3947 218.466 27.709 225.792 27.709H227.692C243.328 27.709 256.005 38.2459 256.005 51.2456H255.995Z"
                      fill="#E2E6F3" />
                  </g>
                  <g opacity="0.75">
                    <path
                      d="M205.506 15.1294C205.281 14.9758 204.917 15.0629 204.856 15.4008L203.136 27.9806C203.059 28.3902 202.501 28.4517 202.342 28.0728L200.268 23.2549C200.105 22.876 199.552 22.9374 199.475 23.3419L197.488 33.8482C197.417 34.227 196.915 34.3141 196.72 33.9813C195.722 32.2763 193.684 28.7691 193.003 27.4021C192.153 25.692 190.31 25.8712 190.065 25.9019C190.049 25.9019 190.034 25.9019 190.034 25.9019C189.696 25.9326 189.358 26.076 189.087 26.3627L178.719 37.2222C177.956 38.021 176.625 37.7598 176.22 36.7256L171.976 25.7893C171.577 24.7602 170.24 24.499 169.477 25.2926L158.132 37.1864C157.492 37.8571 156.391 37.7906 155.833 37.0482L146.443 24.4683C145.905 23.7464 144.861 23.6542 144.2 24.2686L131.744 35.9627C131.094 36.5669 130.064 36.485 129.517 35.7784L120.096 23.5262C119.548 22.8146 118.504 22.7429 117.853 23.3624L108.407 32.4453C107.742 33.0802 106.667 32.9829 106.134 32.2302L98.8792 21.9698C98.3108 21.1557 97.123 21.1147 96.4882 21.8776L87.8253 32.3429C87.2467 33.0392 86.192 33.075 85.5674 32.4197L76.1263 22.4203C75.5375 21.7957 74.5494 21.7854 73.9555 22.3998L66.4856 30.0491C65.8968 30.6482 64.9342 30.6533 64.3403 30.0645L58.4883 24.2123C58.4985 24.1611 58.5139 24.1099 58.519 24.0536L59.9833 14.1362C60.1164 13.2094 61.3247 12.9483 61.8367 13.7266L62.702 15.0373C63.2191 15.8206 64.4325 15.5442 64.5554 14.6174L66.1988 2.44209C66.3166 1.59729 67.3559 1.25937 67.9447 1.87889L74.8412 9.12369C75.215 9.51793 75.8191 9.54865 76.239 9.20049L85.7876 1.08529C86.2484 0.69105 86.9549 0.788331 87.2928 1.29521L92.597 9.30801C92.935 9.82001 93.6466 9.92241 94.1125 9.51793L103.917 1.01361C104.347 0.63985 104.997 0.696168 105.361 1.13137L111.694 8.73457C112.053 9.16465 112.688 9.22097 113.123 8.86769L122.676 1.01361C123.127 0.64497 123.787 0.726888 124.13 1.18769L129.89 8.82161C130.239 9.28241 130.899 9.36433 131.339 9.0008L140.079 1.89937V12.3339C140.079 13.3528 141.482 13.6242 141.866 12.6821L145.071 4.78193L148.634 9.90705C148.993 10.4242 149.735 10.4907 150.181 10.0504L159.202 1.15697C159.637 0.726889 160.349 0.778088 160.722 1.25937L166.585 8.86257C166.928 9.30801 167.568 9.39505 168.008 9.04689L178.376 1.04433C178.857 0.670569 179.559 0.80369 179.866 1.32593L185.119 10.076C185.426 10.5931 186.117 10.7314 186.603 10.3627L202.204 2.57009C202.716 2.18097 203.458 2.36528 203.735 2.94384L205.429 14.9451C205.46 15.0014 205.481 15.0629 205.496 15.1294H205.506Z"
                      fill="#E2E6F3" />
                  </g>
                  <path
                    d="M177.63 38.4512C177.481 38.4512 177.333 38.4358 177.184 38.4051C176.416 38.2515 175.786 37.7293 175.505 36.9971L171.26 26.0557C171.127 25.7178 170.841 25.6205 170.718 25.6C170.595 25.5744 170.293 25.5488 170.037 25.815L158.691 37.7088C158.23 38.1952 157.58 38.4461 156.909 38.4051C156.239 38.3642 155.624 38.0313 155.225 37.4989L145.84 24.919C145.712 24.745 145.528 24.6425 145.313 24.6272C145.098 24.6118 144.898 24.6784 144.744 24.8269L132.283 36.5209C131.812 36.9561 131.182 37.1763 130.542 37.1251C129.907 37.0739 129.313 36.7514 128.924 36.2445L119.498 23.9923C119.37 23.8285 119.181 23.7261 118.971 23.7056C118.761 23.6851 118.556 23.7619 118.408 23.9104L108.962 32.9933C108.48 33.4489 107.83 33.6845 107.17 33.6179C106.509 33.5565 105.91 33.2083 105.526 32.6656L98.2763 22.4051C98.1432 22.2157 97.9333 22.103 97.7029 22.0928C97.4725 22.0826 97.2523 22.185 97.1038 22.359L88.441 32.8243C88.0263 33.3261 87.4119 33.6281 86.7617 33.6486C86.1114 33.6742 85.4817 33.408 85.0311 32.9369L75.59 22.9376C75.4467 22.7891 75.2572 22.7072 75.0525 22.7072C74.8477 22.7072 74.6633 22.784 74.5251 22.9274L67.0552 30.5766C66.6251 31.0169 66.0517 31.2576 65.4424 31.2627H65.427C64.8229 31.2627 64.2495 31.0272 63.8194 30.5971L57.6602 24.4377L57.7626 24.0179C57.7728 23.9872 57.7779 23.9565 57.783 23.9206L59.2473 14.0185C59.3548 13.2813 59.8976 12.6976 60.6246 12.5389C61.3516 12.3801 62.0889 12.6771 62.4985 13.3018L63.3637 14.6125C63.4405 14.7302 63.548 14.7353 63.6248 14.7149C63.7016 14.6944 63.7989 14.6483 63.8194 14.5101L65.4629 2.33471C65.5602 1.64863 66.0261 1.09055 66.6865 0.87551C67.3419 0.66559 68.0484 0.839672 68.5246 1.34143L75.4211 8.58623C75.5132 8.68351 75.6566 8.68863 75.7641 8.60159L85.3178 0.49151C85.707 0.16383 86.2189 0.0153486 86.7207 0.0819086C87.2224 0.148469 87.6781 0.440308 87.9597 0.865268L93.2588 8.87807C93.3151 8.95999 93.3919 8.98047 93.4329 8.99071C93.4738 9.00095 93.5558 8.99583 93.6326 8.93439L103.437 0.43519C103.801 0.12287 104.267 -0.0307282 104.748 0.00511176C105.229 0.0460718 105.669 0.271347 105.977 0.639987L112.31 8.24319C112.397 8.34559 112.551 8.36095 112.658 8.27391L122.217 0.41983C122.601 0.10751 123.077 -0.0358517 123.569 0.0255883C124.055 0.0870283 124.485 0.332789 124.777 0.721909L130.537 8.35583C130.593 8.42751 130.665 8.44799 130.706 8.45311C130.752 8.45823 130.823 8.45311 130.885 8.40191L140.874 0.281588V12.3238C140.874 12.3699 140.874 12.4569 141.007 12.4825C141.135 12.5081 141.166 12.4262 141.181 12.3853L144.919 3.17439L149.291 9.45663C149.352 9.53855 149.429 9.55903 149.475 9.55903C149.521 9.55903 149.598 9.55903 149.675 9.48735L158.696 0.593909C159.06 0.235509 159.561 0.0511936 160.068 0.0870336C160.58 0.122874 161.051 0.373749 161.359 0.778229L167.221 8.38143C167.277 8.45311 167.349 8.47359 167.385 8.47871C167.421 8.48383 167.497 8.48383 167.564 8.42751L177.932 0.424948C178.336 0.112628 178.853 -0.0102464 179.35 0.0870336C179.846 0.184314 180.287 0.481271 180.553 0.916471L185.801 9.66655C185.852 9.74847 185.924 9.77407 185.965 9.78431C186.006 9.79455 186.088 9.79455 186.164 9.73823L186.221 9.69215L186.282 9.66143L201.826 1.89951C202.241 1.60767 202.758 1.51551 203.26 1.63327C203.782 1.76127 204.217 2.11455 204.453 2.60095L204.504 2.70335L206.204 14.7149C206.229 14.7917 206.255 14.8633 206.27 14.9453L206.705 16.8601L205.553 16.0665L203.905 28.1037C203.813 28.6259 203.393 29.0099 202.871 29.0714C202.348 29.1277 201.857 28.8461 201.652 28.3545L200.029 24.5914L198.258 33.9712C198.165 34.4627 197.781 34.8365 197.29 34.9184C196.798 35.0003 196.317 34.775 196.066 34.3449C195.38 33.1725 193.081 29.2301 192.324 27.7248C191.735 26.5472 190.481 26.6086 190.209 26.6394H190.199L190.112 26.6496C189.933 26.6649 189.779 26.7417 189.651 26.8749L179.283 37.7395C178.848 38.1952 178.254 38.4461 177.64 38.4461H177.63V38.4512ZM170.569 24.0538C170.718 24.0538 170.866 24.0691 171.02 24.0998C171.788 24.2534 172.412 24.7757 172.694 25.5078L176.938 36.4441C177.036 36.6848 177.23 36.8537 177.486 36.9049C177.742 36.9561 177.988 36.8742 178.167 36.6899L188.535 25.8304C188.909 25.4362 189.395 25.1955 189.933 25.1392C189.953 25.1392 189.979 25.1392 189.994 25.1341C190.388 25.088 192.631 24.9293 193.691 27.0592C194.208 28.0934 195.616 30.5613 196.911 32.7782L198.718 23.1987C198.816 22.6765 199.236 22.2925 199.758 22.2361C200.28 22.1798 200.766 22.4665 200.971 22.9478L202.548 26.6086L204.099 15.2627C204.156 14.9402 204.34 14.6637 204.601 14.4896L203.009 3.20511C202.968 3.16415 202.917 3.14367 202.886 3.13855C202.845 3.12831 202.763 3.12319 202.681 3.17951L202.625 3.22559L202.563 3.25631L187.019 11.0182C186.625 11.2896 186.139 11.392 185.668 11.2998C185.171 11.2025 184.736 10.9005 184.48 10.4653L179.232 1.71519C179.186 1.63327 179.104 1.60767 179.063 1.60255C179.022 1.59231 178.94 1.58719 178.863 1.64863L168.496 9.65119C168.122 9.94303 167.651 10.071 167.18 10.0096C166.709 9.94815 166.284 9.70751 165.992 9.32863L160.13 1.72543C160.073 1.64863 159.992 1.62815 159.951 1.62815C159.91 1.62815 159.828 1.62815 159.756 1.69983L150.735 10.5933C150.361 10.967 149.844 11.1514 149.317 11.1001C148.789 11.0489 148.318 10.7776 148.016 10.3424L145.262 6.38463L142.589 12.9741C142.282 13.7318 141.504 14.1568 140.695 13.9981C139.886 13.8394 139.323 13.1533 139.323 12.3341V3.51743L131.837 9.60511C131.463 9.91231 130.987 10.0557 130.501 9.99423C130.015 9.93791 129.584 9.68703 129.288 9.29791L123.533 1.66399C123.482 1.59231 123.415 1.57183 123.369 1.56671C123.328 1.56671 123.251 1.56671 123.174 1.62303L113.621 9.47711C112.868 10.0966 111.747 9.99423 111.117 9.24671L104.784 1.64863C104.727 1.57695 104.651 1.56159 104.61 1.55647C104.574 1.55647 104.497 1.55647 104.43 1.61279L94.6258 10.1171C94.2367 10.4499 93.7247 10.6035 93.2127 10.5318C92.7059 10.4601 92.2502 10.1785 91.9686 9.74847L86.6644 1.73567C86.6132 1.65375 86.5313 1.63327 86.4903 1.62815C86.4493 1.62303 86.3725 1.62815 86.2957 1.68447L76.7471 9.79455C76.0252 10.4089 74.9501 10.3526 74.2998 9.66143L67.4033 2.41663C67.3112 2.31935 67.2036 2.33471 67.1473 2.35519C67.091 2.37567 66.9937 2.42687 66.9733 2.55999L65.3298 14.7302C65.2325 15.4726 64.6898 16.0666 63.9576 16.2304C63.2255 16.3942 62.4831 16.0973 62.0684 15.4726L61.2031 14.1619C61.1212 14.0441 61.0137 14.039 60.942 14.0544C60.8652 14.0698 60.7679 14.1209 60.7475 14.2592L59.3139 23.9616L64.8843 29.5321C65.0226 29.6704 65.212 29.7472 65.4066 29.7472H65.4117C65.6114 29.7472 65.8008 29.6653 65.939 29.5219L73.409 21.8726C73.8442 21.4272 74.4227 21.1865 75.0473 21.1865C75.672 21.1917 76.2556 21.4477 76.6857 21.8982L86.1268 31.8976C86.2701 32.0563 86.4749 32.1382 86.69 32.128C86.905 32.1177 87.0996 32.0256 87.2327 31.8617L95.8955 21.3965C96.3512 20.8435 97.0219 20.5465 97.7387 20.5721C98.4504 20.6029 99.0955 20.951 99.5051 21.5347L106.755 31.7952C106.878 31.9744 107.067 32.0819 107.287 32.1024C107.507 32.1229 107.712 32.0512 107.871 31.8976L117.317 22.8198C117.778 22.3693 118.413 22.144 119.058 22.1901C119.703 22.2362 120.297 22.5587 120.691 23.0656L130.112 35.3178C130.24 35.4816 130.429 35.5891 130.639 35.6045C130.854 35.6198 131.054 35.5481 131.202 35.4048L143.664 23.7107C144.135 23.2704 144.775 23.0451 145.415 23.1014C146.06 23.1577 146.654 23.4854 147.043 24.0077L156.428 36.5875C156.602 36.823 156.848 36.8742 156.976 36.8794C157.109 36.8845 157.355 36.8691 157.56 36.6489L168.905 24.7552C169.34 24.2995 169.934 24.0486 170.549 24.0486L170.569 24.0538Z"
                    fill="#CCD2D6" />
                  <g opacity="0.75">
                    <path
                      d="M219.576 140.094C213.068 143.094 196.04 151.399 184.197 161.29C184.847 157.164 186.793 143.422 189.916 109.778C191.683 90.7419 192.179 71.2756 192.189 55.6954C192.2 42.7316 191.877 32.4558 191.672 27.3409C191.636 26.4193 190.843 25.8407 190.054 25.8971C190.3 25.8612 192.143 25.6871 192.993 27.3972C193.679 28.7643 195.712 32.2715 196.71 33.9764C196.905 34.3092 197.407 34.2222 197.478 33.8433L199.465 23.3371C199.542 22.9326 200.1 22.8711 200.258 23.25L202.337 28.0679C202.496 28.4468 203.054 28.3854 203.131 27.9758L204.851 15.3959C204.907 15.0631 205.281 14.9761 205.501 15.1246C205.583 15.1809 205.65 15.2731 205.67 15.4011C206.653 21.2532 209.981 38.3796 213.063 71.0247C216.212 104.325 220.246 128.077 221.69 135.998C221.997 137.687 221.127 139.361 219.571 140.083L219.576 140.094Z"
                      fill="#E2E6F3" />
                  </g>
                  <path
                    d="M183.122 163.19L183.44 161.167C184.121 156.821 186.051 143.099 189.154 109.706C190.643 93.65 191.406 75.474 191.422 55.6954C191.432 42.6957 191.104 32.3738 190.905 27.3767C190.894 27.1156 190.771 26.9517 190.674 26.8596C190.521 26.7213 190.311 26.6496 190.111 26.665L189.957 25.1392C190.224 25.1034 192.594 24.8525 193.69 27.0541C194.207 28.0884 195.615 30.5562 196.91 32.7732L198.718 23.1936C198.815 22.6714 199.235 22.2874 199.757 22.2311C200.274 22.1748 200.765 22.4615 200.97 22.9428L202.547 26.6036L204.099 15.2576C204.17 14.8583 204.431 14.5306 204.8 14.377C205.174 14.2183 205.609 14.2644 205.942 14.4896C206.203 14.6688 206.377 14.9453 206.433 15.273C206.546 15.9284 206.684 16.7271 206.848 17.6743C208.118 24.9396 211.092 41.9482 213.831 70.953C216.944 103.885 220.897 127.314 222.453 135.859C222.822 137.892 221.772 139.914 219.899 140.774C213.217 143.857 196.414 152.074 184.689 161.864L183.117 163.174V163.185L183.122 163.19ZM192.471 28.0525C192.671 33.2954 192.968 43.2743 192.958 55.6954C192.942 75.5252 192.179 93.7421 190.679 109.85C187.945 139.315 186.117 153.503 185.252 159.437C197.002 150.093 212.807 142.367 219.259 139.397C220.498 138.829 221.189 137.487 220.948 136.146C219.387 127.58 215.429 104.095 212.311 71.1066C209.577 42.1632 206.607 25.1956 205.343 17.9456C205.332 17.8893 205.322 17.8279 205.312 17.7716L203.894 28.114C203.802 28.6311 203.382 29.0202 202.86 29.0765C202.337 29.138 201.846 28.8512 201.641 28.3648L200.018 24.6016L198.246 33.9815C198.154 34.473 197.775 34.8468 197.279 34.9287C196.792 35.0106 196.306 34.7904 196.055 34.3552C195.415 33.2596 193.352 29.7268 192.476 28.0474L192.471 28.0525Z"
                    fill="#CCD2D6" />
                  <path
                    d="M192.19 55.6899C192.18 71.2701 191.683 90.7312 189.917 109.772C186.789 143.421 184.843 157.163 184.198 161.285C184.07 162.094 183.328 162.647 182.519 162.539C170.124 160.901 81.0117 149.483 37.1649 154.03C36.1717 154.132 35.3474 153.257 35.5266 152.274C37.2622 142.459 44.8909 98.3651 47.3279 68.9712C49.4169 43.704 51.644 27.8371 52.5861 21.6829C52.7755 20.4643 54.2654 19.9779 55.1409 20.8483L64.3567 30.0643C64.9506 30.6583 65.9132 30.6531 66.502 30.0541L73.9719 22.4048C74.5658 21.7955 75.5591 21.8058 76.1427 22.4253L85.5838 32.4247C86.2084 33.08 87.2631 33.0493 87.8417 32.3479L96.5046 21.8826C97.1394 21.1197 98.3272 21.1607 98.8955 21.9747L106.15 32.2352C106.683 32.9879 107.758 33.0851 108.424 32.4503L117.87 23.3674C118.52 22.7427 119.565 22.8247 120.112 23.5312L129.533 35.7834C130.081 36.4899 131.11 36.577 131.76 35.9677L144.217 24.2736C144.872 23.6592 145.917 23.7463 146.459 24.4733L155.849 37.0531C156.402 37.7955 157.508 37.8672 158.148 37.1914L169.494 25.2976C170.257 24.4989 171.593 24.76 171.992 25.7943L176.237 36.7306C176.636 37.7597 177.972 38.0259 178.735 37.2272L189.103 26.3677C189.374 26.081 189.712 25.9376 190.05 25.9069C190.06 25.9069 190.066 25.9069 190.081 25.9069C190.874 25.8506 191.663 26.4291 191.699 27.3507C191.898 32.4605 192.226 42.7415 192.216 55.7053H192.211L192.19 55.6899Z"
                    fill="#F8F9FC" />
                  <path
                    d="M182.703 163.323C182.611 163.323 182.509 163.323 182.417 163.308C172.197 161.956 81.3244 150.226 37.2421 154.798C36.5253 154.875 35.8341 154.614 35.3426 154.086C34.8511 153.559 34.6412 152.847 34.7692 152.136C36.3103 143.421 44.113 98.4371 46.5603 68.8998C48.6697 43.3613 50.9429 27.2845 51.8236 21.5552C51.9567 20.7053 52.5455 20.0089 53.3646 19.7427C54.1838 19.4713 55.0747 19.6864 55.6788 20.2905L64.8998 29.5117C65.038 29.6499 65.2274 29.7267 65.422 29.7267H65.4271C65.6268 29.7267 65.8162 29.6448 65.9545 29.5014L73.4244 21.8573C73.8596 21.4118 74.4381 21.1661 75.0628 21.1712C75.6874 21.1712 76.2711 21.4272 76.7011 21.8829L86.1422 31.8822C86.2856 32.0409 86.4853 32.1177 86.7054 32.1126C86.9204 32.1024 87.115 32.0102 87.2481 31.8413L95.911 21.376C96.3667 20.823 97.0425 20.5261 97.7542 20.5517C98.4658 20.5773 99.1109 20.9305 99.5205 21.5142L106.77 31.7747C106.893 31.9488 107.083 32.0614 107.303 32.0819C107.523 32.1024 107.728 32.0307 107.886 31.8822L117.333 22.7993C117.793 22.3488 118.428 22.1235 119.073 22.1696C119.719 22.2208 120.312 22.5382 120.707 23.0502L130.127 35.3024C130.255 35.4713 130.445 35.5737 130.655 35.5891C130.87 35.6045 131.069 35.5328 131.218 35.3894L143.68 23.6953C144.151 23.255 144.791 23.0297 145.431 23.0861C146.076 23.1424 146.67 23.4752 147.059 23.9923L156.444 36.5721C156.618 36.8128 156.863 36.8589 156.991 36.864C157.124 36.8742 157.37 36.8537 157.575 36.6387L168.921 24.7449C169.463 24.1766 170.242 23.9309 171.015 24.0845C171.783 24.2381 172.407 24.7603 172.689 25.4925L176.933 36.4288C177.026 36.6694 177.225 36.8384 177.481 36.8896C177.732 36.9408 177.983 36.8589 178.162 36.6745L188.525 25.815C188.904 25.4208 189.385 25.1801 189.928 25.1238C189.969 25.1238 189.999 25.1187 190.025 25.1136C190.634 25.0777 191.249 25.2928 191.699 25.6973C192.155 26.1069 192.416 26.6752 192.442 27.2947C192.641 32.3021 192.964 42.6445 192.954 55.6749C192.938 75.5046 192.175 93.7216 190.675 109.829C187.567 143.268 185.637 157.025 184.946 161.388C184.777 162.499 183.794 163.308 182.698 163.308L182.703 163.323ZM61.705 152.212C108.69 152.212 174.036 160.65 182.616 161.787C183.011 161.833 183.379 161.562 183.441 161.172C184.127 156.82 186.052 143.104 189.155 109.711C190.644 93.6499 191.407 75.479 191.423 55.6953C191.433 42.6957 191.105 32.3686 190.906 27.3766C190.895 27.1155 190.772 26.9517 190.675 26.8595C190.532 26.7264 190.322 26.6547 190.132 26.6598H190.097C189.917 26.6752 189.764 26.752 189.636 26.8851L179.268 37.7497C178.725 38.3181 177.947 38.5638 177.179 38.4153C176.411 38.2617 175.781 37.7395 175.5 37.0073L171.255 26.0659C171.122 25.728 170.83 25.6307 170.713 25.6102C170.59 25.5846 170.283 25.559 170.032 25.8253L158.686 37.719C158.22 38.2054 157.575 38.4563 156.899 38.4153C156.223 38.3744 155.614 38.0416 155.215 37.5091L145.825 24.9293C145.697 24.7552 145.513 24.6528 145.298 24.6374C145.082 24.6221 144.883 24.6886 144.729 24.8371L132.267 36.5312C131.801 36.9664 131.167 37.1865 130.527 37.1353C129.887 37.0841 129.298 36.7616 128.904 36.2547L119.483 24.0025C119.355 23.8387 119.166 23.7312 118.951 23.7158C118.741 23.7005 118.536 23.7721 118.387 23.9206L108.941 33.0035C108.46 33.4592 107.81 33.6896 107.149 33.6281C106.489 33.5667 105.89 33.2185 105.511 32.6809L98.261 22.4205C98.1279 22.231 97.918 22.1184 97.6876 22.1081C97.4572 22.0979 97.237 22.1952 97.0886 22.3744L88.4257 32.8397C88.0059 33.3414 87.3966 33.6435 86.7464 33.664C86.0961 33.6896 85.4664 33.4233 85.0158 32.9523L75.5748 22.9529C75.4365 22.8045 75.242 22.7225 75.0372 22.7225C74.8324 22.7225 74.6481 22.7993 74.5098 22.9427L67.0399 30.592C66.6098 31.0272 66.0364 31.2729 65.4271 31.2781H65.4118C64.8076 31.2781 64.2342 31.0425 63.8041 30.6125L54.5832 21.3913C54.3784 21.1917 54.0968 21.1251 53.8254 21.2121C53.5592 21.2992 53.3698 21.5193 53.3288 21.8009C52.4482 27.5097 50.1801 43.5456 48.0758 69.0381C45.6285 98.6419 37.8104 143.683 36.2642 152.412C36.2232 152.643 36.2949 152.873 36.4536 153.047C36.6123 153.221 36.8376 153.303 37.068 153.277C44.2256 152.535 52.6223 152.218 61.6896 152.218L61.705 152.212Z"
                    fill="#CCD2D6" />
                  <path
                    d="M104.112 75.2388C106.293 75.2388 108.059 72.7044 108.059 69.5709C108.059 66.4375 106.293 63.9082 104.112 63.9082C101.93 63.9082 100.164 66.4426 100.164 69.5709C100.164 72.6992 101.93 75.2388 104.112 75.2388Z"
                    fill="#E2E6F3" />
                  <path
                    d="M133.619 75.2388C135.8 75.2388 137.567 72.7044 137.567 69.5709C137.567 66.4375 135.8 63.9082 133.619 63.9082C131.438 63.9082 129.672 66.4426 129.672 69.5709C129.672 72.6992 131.438 75.2388 133.619 75.2388Z"
                    fill="#E2E6F3" />
                  <path
                    d="M107.204 97.4588C107.44 96.9622 107.701 96.4707 107.988 95.9996C108.126 95.7692 108.274 95.5439 108.423 95.3238C108.494 95.2214 108.566 95.119 108.638 95.0166C108.72 94.8988 108.868 94.7657 108.919 94.6377C108.832 94.8579 108.761 94.8374 108.853 94.7247C108.894 94.6735 108.935 94.6223 108.971 94.5763C109.063 94.4636 109.15 94.3561 109.242 94.2486C109.426 94.0284 109.616 93.8185 109.81 93.6137C110.189 93.2092 110.594 92.8303 111.008 92.4668C111.106 92.3849 111.203 92.303 111.3 92.2262C111.346 92.1852 111.397 92.1443 111.444 92.1033C111.474 92.0777 111.725 91.8985 111.51 92.047C111.295 92.1955 111.653 91.9395 111.694 91.9087C111.822 91.8166 111.95 91.7244 112.078 91.6374C112.534 91.3251 113 91.0332 113.481 90.7721C113.701 90.6492 113.922 90.5366 114.152 90.4239C114.28 90.3625 114.408 90.3011 114.536 90.2447C114.592 90.2191 114.649 90.1935 114.71 90.1679C114.93 90.0707 114.766 90.1679 114.649 90.1935C114.91 90.1372 115.181 89.9836 115.437 89.8915C115.693 89.7993 115.975 89.7123 116.246 89.6355C116.758 89.4921 117.275 89.3692 117.802 89.2822C117.874 89.2668 118.34 89.2003 118.064 89.2361C117.787 89.2719 118.227 89.2208 118.284 89.2105C118.581 89.1798 118.878 89.1593 119.175 89.1491C119.697 89.1337 120.224 89.1439 120.741 89.19C120.864 89.2003 120.987 89.2156 121.11 89.2259C121.156 89.231 121.463 89.2617 121.182 89.2361C120.931 89.2054 121.141 89.231 121.202 89.2361C121.479 89.2822 121.75 89.3283 122.016 89.3897C122.543 89.5075 123.055 89.6508 123.567 89.8249C123.813 89.9068 124.054 90.0041 124.3 90.1014C124.489 90.1731 124.008 89.9734 124.187 90.0502C124.243 90.0758 124.3 90.1014 124.356 90.127C124.494 90.1884 124.637 90.255 124.771 90.3215C125.252 90.5571 125.723 90.8182 126.179 91.1049C126.383 91.238 126.588 91.3712 126.788 91.5145C126.9 91.5913 127.013 91.6784 127.121 91.7552C127.279 91.8729 126.875 91.5606 127.028 91.6835C127.085 91.7295 127.146 91.7756 127.208 91.8268C127.684 92.2159 128.129 92.6255 128.544 93.071C128.744 93.2809 128.933 93.5011 129.117 93.7263C129.163 93.7827 129.21 93.8441 129.261 93.9004C129.43 94.1103 129.102 93.6905 129.215 93.8441C129.302 93.967 129.394 94.0899 129.481 94.2127C129.819 94.6991 130.121 95.206 130.387 95.7385C130.459 95.8768 130.52 96.015 130.587 96.1532C130.612 96.2096 130.633 96.2659 130.658 96.3171L130.577 96.1174L130.648 96.2863C130.761 96.5679 130.858 96.8598 130.95 97.1516C131.191 97.9145 132.031 98.4879 132.84 98.2268C133.649 97.9657 134.171 97.1567 133.915 96.3375C132.45 91.6015 128.396 87.9868 123.675 86.6352C118.913 85.2732 113.737 86.4918 109.841 89.4767C107.609 91.1868 105.75 93.3577 104.542 95.9075C104.199 96.6294 104.317 97.6022 105.09 98.0067C105.776 98.3651 106.825 98.2319 107.194 97.4588H107.199H107.204Z"
                    fill="#E2E6F3" />
                  <path
                    d="M46.4009 139.659C45.981 139.659 45.638 139.321 45.6329 138.901C45.6278 138.476 45.9657 138.128 46.3906 138.123L129.666 136.976C130.091 136.966 130.439 137.309 130.444 137.734C130.449 138.159 130.111 138.507 129.686 138.512L46.4162 139.659H46.406H46.4009Z"
                    fill="#E2E6F3" />
                  <path
                    d="M100.165 144.476H91.1078C90.6829 144.476 90.3398 144.133 90.3398 143.708C90.3398 143.283 90.6829 142.94 91.1078 142.94H100.165C100.59 142.94 100.933 143.283 100.933 143.708C100.933 144.133 100.59 144.476 100.165 144.476Z"
                    fill="#E2E6F3" />
                  <path
                    d="M142.231 117.883C141.837 117.883 141.499 117.575 141.463 117.171C141.432 116.746 141.75 116.377 142.17 116.347L179.309 113.485C179.734 113.454 180.103 113.766 180.134 114.191C180.164 114.616 179.847 114.985 179.427 115.015L142.287 117.877H142.231V117.883Z"
                    fill="#E2E6F3" />
                  <path
                    d="M193.188 154.916C193.05 154.916 192.907 154.88 192.779 154.798C192.421 154.573 192.313 154.092 192.543 153.738L205.19 133.904L201.667 25.5848C201.657 25.1599 201.984 24.8066 202.409 24.7912C202.824 24.781 203.188 25.1087 203.203 25.5336L206.736 134.329L206.608 134.528L193.839 154.563C193.695 154.793 193.444 154.916 193.194 154.916H193.188Z"
                    fill="#CCD2D6" />
                  <path
                    d="M218.727 140.811C218.62 140.811 218.512 140.785 218.405 140.739L205.641 134.81C205.257 134.631 205.088 134.175 205.267 133.791C205.446 133.407 205.902 133.238 206.286 133.417L219.05 139.346C219.434 139.525 219.603 139.981 219.423 140.365C219.29 140.647 219.014 140.811 218.727 140.811Z"
                    fill="#CCD2D6" />
                </svg>
                <span class="text-[#A8AAAE] text-[20px] font-medium">В вашей корзине <br>
                  пока пусто</span>
              </div>
            </div>
            <div class="mt-6 px-8">
              <div class="flex items-center justify-between gap-x-4 text-lg">
                <span class="font-medium text-[#A8AAAE]">Общая сумма:</span>
                <strong class="font-semibold text-dark">
                  {{ formatNumber(ordersSum) }} сум
                </strong>
              </div>
              <div class="grid grid-cols-2 mt-6">
                <ElButton
                  @click="clearOrders"
                  class="!bg-[#E2E6F3] border-none text-sm !text-dark-gray"
                  size="large"
                >
                  Отменить
                </ElButton>
                <ElButton
                  type="primary"
                  size="large"
                  class="!bg-blue"
                  @click="createOrder"
                >
                  Продать
                </ElButton>
              </div>
            </div>
          </div>
        </Teleport>
      </Transition>
    </div>
  </div>
</template>

<style lang="scss">
.app-tabs2 {
  @apply bg-[#EFF1F8] p-1 inline-flex items-center rounded-lg font-medium text-xs leading-5;
}

.app-tab {
  @apply rounded-lg py-2.5 px-5 transition duration-100 text-dark-gray;

  &--active {
    @apply bg-white shadow-[0px_1.5px_4px_-1px_#0A090B12] text-dark;
  }
}

.menu {
  &__card {
    @apply rounded-2xl border border-[#E2E6F3] p-4 bg-[#F8F9FC] flex flex-col gap-x-3 text-center;

    &-img {
      @apply rounded-xl object-contain w-full mt-3;
    }

    &-title {
      @apply text-dark font-semibold text-xl;
    }

    &-subtitles {
      @apply flex flex-col gap-y-1 text-sm font-medium text-cool-gray mt-3;
    }

    &__actions {
      @apply mt-3.5 flex items-center justify-center gap-x-2 text-base font-medium text-dark-gray;
    }

    &__action {
      &-btn {
        @apply size-7 text-[#292D324D] rounded-lg shadow-[0_2px_8.4px_0_#292D3214] bg-white flex items-center justify-center;

        &__icon {
          @apply size-4;
        }
      }
    }
  }
}
</style>